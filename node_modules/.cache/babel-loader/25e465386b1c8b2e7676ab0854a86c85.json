{"ast":null,"code":"import _regeneratorRuntime from\"/Users/markkrasner/Downloads/MDB5-REACT-UI-KIT-Free-4.0.0/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/markkrasner/Downloads/MDB5-REACT-UI-KIT-Free-4.0.0/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/markkrasner/Downloads/MDB5-REACT-UI-KIT-Free-4.0.0/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{Component,useEffect,useState}from'react';import{MDBRow,MDBCol,MDBInput,MDBCheckbox,MDBBtn,MDBTextArea}from'mdb-react-ui-kit';import{ethers}from\"ethers\";import abi from\"./abi.json\";import DateTimePicker from'react-datetime-picker';import Navbar from'./Navbar.js';import LoadingSpin from\"react-loading-spin\";import detectEthereumProvider from'@metamask/detect-provider';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var defaultValues={ReactDatepicker:new Date()};export default function Form(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),propName=_useState2[0],setPropName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),propDescription=_useState4[0],setPropDescription=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),transaction=_useState6[0],setTransactionSuccess=_useState6[1];var _useState7=useState(new Date()),_useState8=_slicedToArray(_useState7,2),propDate=_useState8[0],setPropDate=_useState8[1];React.useEffect(function(){function checkProvider(){return _checkProvider.apply(this,arguments);}function _checkProvider(){_checkProvider=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var provider;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return detectEthereumProvider();case 2:provider=_context.sent;if(provider){console.log('hello');}else{alert('Install Metamask to continue');}case 4:case\"end\":return _context.stop();}}},_callee);}));return _checkProvider.apply(this,arguments);}checkProvider();},[]);var submit=function submit(event){if(propName.replace(/[^a-zA-Z\\s]/gi,'')!==propName){alert('Your input most be composed of alphabetic characters only.');window.location.reload(false);}if(propName.length>50){alert('Your input must be 50 characters or less');window.location.reload(false);}if(propDescription.length>500){alert('Your description input must be 500 characters or less');window.location.reload(false);}var DEPLOYED_ADDRESS='0x1eC7b4E7AD7BEa7371e849F4c31f267b95380055';function connect(){return _connect.apply(this,arguments);}function _connect(){_connect=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return window.ethereum.request({method:\"eth_requestAccounts\"});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return _connect.apply(this,arguments);}connect();setTransactionSuccess(1);var thisProvider=new ethers.providers.Web3Provider(window.ethereum);var signer=thisProvider.getSigner();var writeContract=new ethers.Contract(DEPLOYED_ADDRESS,abi,signer);console.log(signer);if(!(value.getTime()>Date.now()+259200)){alert('You must choose a date that is at least 3 days in the future.');}function submitProp(_x,_x2,_x3){return _submitProp.apply(this,arguments);}function _submitProp(){_submitProp=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(name,description,deadline){var txResponse,txReceipt;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return writeContract.createProposal(name,description,deadline);case 2:txResponse=_context3.sent;_context3.next=5;return txResponse.wait();case 5:txReceipt=_context3.sent;if(txReceipt.blockNumber>0){setTransactionSuccess(txReceipt.blockNumber);}else if(!(txReceipt.blockNumber>0)){alert('Your submission was unsuccessful');window.location.reload(false);}case 7:case\"end\":return _context3.stop();}}},_callee3);}));return _submitProp.apply(this,arguments);}var time=Math.floor(value.getTime()/1000);submitProp(propName,propDescription,time);event.preventDefault();};var _useState9=useState(new Date()),_useState10=_slicedToArray(_useState9,2),value=_useState10[0],onChange=_useState10[1];if(transaction==1){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(LoadingSpin,{})});}else if(!(transaction>1)){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{title:\"Submit a Proposal\",message:\"If you hold a governance token you can submit a proposal here\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submit,children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(MDBInput,{wrapperClass:\"mb-4\",id:\"propName\",label:\"Proposal Name\",onChange:function onChange(event){return setPropName(event.target.value);},value:propName}),/*#__PURE__*/_jsx(MDBRow,{className:\"mb-4\",children:/*#__PURE__*/_jsx(MDBCol,{children:/*#__PURE__*/_jsx(MDBTextArea,{label:\"Description\",id:\"propDescription\",onChange:function onChange(event){return setPropDescription(event.target.value);},value:propDescription,rows:4})})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Deadline (must leave at least a 3 days window):\"}),/*#__PURE__*/_jsx(DateTimePicker,{onChange:onChange,value:value,id:\"dateSubmit\"})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(MDBBtn,{className:\"mb-4\",type:\"submit\",id:\"globalSubmit\",block:true,children:\"Submit Proposal\"})]})]});}else if(transaction>1){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{title:\"Submit a Proposal\",message:\"Your proposal submission was successful\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Success!\"}),/*#__PURE__*/_jsx(MDBBtn,{className:\"mb-4\",href:\"/submit-proposal\",children:\"Go Back\"})]});}}","map":{"version":3,"names":["React","Component","useEffect","useState","MDBRow","MDBCol","MDBInput","MDBCheckbox","MDBBtn","MDBTextArea","ethers","abi","DateTimePicker","Navbar","LoadingSpin","detectEthereumProvider","defaultValues","ReactDatepicker","Date","Form","propName","setPropName","propDescription","setPropDescription","transaction","setTransactionSuccess","propDate","setPropDate","checkProvider","provider","console","log","alert","submit","event","replace","window","location","reload","length","DEPLOYED_ADDRESS","connect","ethereum","request","method","thisProvider","providers","Web3Provider","signer","getSigner","writeContract","Contract","value","getTime","now","submitProp","name","description","deadline","createProposal","txResponse","wait","txReceipt","blockNumber","time","Math","floor","preventDefault","onChange","target"],"sources":["/Users/markkrasner/Downloads/MDB5-REACT-UI-KIT-Free-4.0.0/src/components/Form.js"],"sourcesContent":["\nimport React, { Component, useEffect, useState } from 'react';\nimport {\n  MDBRow,\n  MDBCol,\n  MDBInput,\n  MDBCheckbox,\n  MDBBtn,\n  MDBTextArea\n} from 'mdb-react-ui-kit';\nimport { ethers } from \"ethers\";\nimport abi from \"./abi.json\";\nimport DateTimePicker from 'react-datetime-picker';\nimport Navbar from './Navbar.js';\nimport LoadingSpin from \"react-loading-spin\";\nimport detectEthereumProvider from '@metamask/detect-provider';\n\n\n\nconst defaultValues = {\n  ReactDatepicker: new Date()\n}\n\n\nexport default function Form() {\n\n  const [propName, setPropName] = useState('');\n  const [propDescription, setPropDescription] = useState('');\n  const [transaction, setTransactionSuccess] = useState('');\n  const [propDate, setPropDate] = useState(new Date());\n  \n\n  React.useEffect(() => {\n    \n    async function checkProvider() {\n      const provider = await detectEthereumProvider();\n      if(provider){\n        console.log('hello');\n        \n      }\n      else{\n        alert('Install Metamask to continue')\n      }\n    }\n    \n    checkProvider();\n  }, []);\n\n  const submit = event => {\n    if(propName.replace(/[^a-zA-Z\\s]/gi, '') !== propName) {\n      alert('Your input most be composed of alphabetic characters only.')\n      window.location.reload(false);\n    }\n    if(propName.length > 50){\n      alert('Your input must be 50 characters or less')\n      window.location.reload(false);\n    }\n    if(propDescription.length > 500){\n      alert('Your description input must be 500 characters or less')\n      window.location.reload(false);\n    }\n\n    \n\n    const DEPLOYED_ADDRESS = '0x1eC7b4E7AD7BEa7371e849F4c31f267b95380055';\n    async function connect() {\n      await window.ethereum.request({\n        method: \"eth_requestAccounts\",\n      });\n    }\n    connect();\n    setTransactionSuccess(1);\n    const thisProvider = new ethers.providers.Web3Provider(window.ethereum);\n    const signer = thisProvider.getSigner();\n    let writeContract = new ethers.Contract(DEPLOYED_ADDRESS, abi, signer);\n\n    console.log(signer);\n\n    if(!(value.getTime() > Date.now() + 259200)){\n      alert('You must choose a date that is at least 3 days in the future.');\n    }\n\n    async function submitProp(name, description, deadline) {\n      \n      let txResponse = await writeContract.createProposal(name, description, deadline);\n      let txReceipt = await txResponse.wait();\n      if(txReceipt.blockNumber > 0){\n        setTransactionSuccess(txReceipt.blockNumber);\n      } else if (!(txReceipt.blockNumber > 0)){\n        alert('Your submission was unsuccessful');\n        window.location.reload(false);\n      }\n    }\n    const time = Math.floor(value.getTime() / 1000);\n    submitProp(propName, propDescription, time);\n    event.preventDefault();\n\n    \n  }\n\n  \n  \n  const [value, onChange] = useState(new Date());\n  \n  if (transaction == 1){\n    return (\n      <>\n      <LoadingSpin />\n      </>\n    )\n  }\n  \n  else if(!(transaction > 1)){\n  return (\n    <>\n    <Navbar\n      title=\"Submit a Proposal\"\n      message=\"If you hold a governance token you can submit a proposal here\" />\n      \n    <form onSubmit={submit}>\n      <br></br>\n      <MDBInput wrapperClass='mb-4' id='propName' label='Proposal Name' onChange={event => setPropName(event.target.value)} value={propName} />\n      <MDBRow className='mb-4'>\n        <MDBCol>\n          <MDBTextArea label='Description' id='propDescription' onChange={event => setPropDescription(event.target.value)} value={propDescription} rows={4} />\n        </MDBCol>\n        \n      </MDBRow>\n      <div>\n      <p>Deadline (must leave at least a 3 days window):</p>\n      <DateTimePicker onChange={onChange} value={value} id='dateSubmit' />\n      </div>\n      <br></br>\n\n\n      <MDBBtn className='mb-4' type='submit' id='globalSubmit' block>\n        Submit Proposal\n      </MDBBtn>\n    </form>\n    </>\n  );\n}\n\n\nelse if (transaction > 1){\n  return (\n    <>\n    <Navbar\n      title=\"Submit a Proposal\"\n      message=\"Your proposal submission was successful\" />\n      <p>Success!</p>\n      <MDBBtn className='mb-4' href='/submit-proposal'>\n        Go Back\n      </MDBBtn>\n      </>\n  );\n}\n\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}